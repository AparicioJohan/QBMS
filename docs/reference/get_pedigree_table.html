<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Get the Pedigree Table — get_pedigree_table • QBMS</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Get the Pedigree Table — get_pedigree_table"><meta property="og:description" content="Get the pedigree table starting from current germplasm list and associated
pedigree string that provides the parentage through which a cultivar was obtained."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">QBMS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/breedbase_example.html">BreedBase Example</a>
    </li>
    <li>
      <a href="../articles/tutorial.html">QBMS Tutorial</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/icarda-git/QBMS/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Get the Pedigree Table</h1>
    <small class="dont-index">Source: <a href="https://github.com/icarda-git/QBMS/blob/HEAD/R/qbms.R" class="external-link"><code>R/qbms.R</code></a></small>
    <div class="hidden name"><code>get_pedigree_table.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Get the pedigree table starting from current germplasm list and associated
pedigree string that provides the parentage through which a cultivar was obtained.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">get_pedigree_table</span><span class="op">(</span>
  <span class="va">data</span>,
  geno_column <span class="op">=</span> <span class="st">"germplasmName"</span>,
  pedigree_column <span class="op">=</span> <span class="st">"pedigree"</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>germplasm dataset as a data.frame.</p></dd>
<dt>geno_column</dt>
<dd><p>name of the column that identifies the genotype/germplasm names.</p></dd>
<dt>pedigree_column</dt>
<dd><p>name of the column that identifies the pedigree strings.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A data.frame that has three columns correspond to the identifiers for the individual,
        female parent and male parent, respectively. The row giving the pedigree of an
        individual appears before any row where that individual appears as a parent.
        Founders use NA in the parental columns.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Khaled Al-Shamaa, <a href="mailto:k.el-shamaa@cgiar.org">k.el-shamaa@cgiar.org</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co"># config your BMS connection</span></span>
<span class="r-in"><span class="fu"><a href="set_qbms_config.html">set_qbms_config</a></span><span class="op">(</span><span class="st">"https://www.bms-uat-test.net/ibpworkbench"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># login using your BMS account (interactive mode)</span></span>
<span class="r-in"><span class="co"># you can pass BMS username and password as parameters (batch mode)</span></span>
<span class="r-in"><span class="fu"><a href="login_bms.html">login_bms</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="set_crop.html">set_crop</a></span><span class="op">(</span><span class="st">"maize"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># select a breeding program by name</span></span>
<span class="r-in"><span class="fu"><a href="set_program.html">set_program</a></span><span class="op">(</span><span class="st">"MC Maize"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># select a specific study/trial by name</span></span>
<span class="r-in"><span class="fu"><a href="set_trial.html">set_trial</a></span><span class="op">(</span><span class="st">"2018 PVT"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># select a specific environment/location dataset</span></span>
<span class="r-in"><span class="fu"><a href="set_study.html">set_study</a></span><span class="op">(</span><span class="st">"2018 PVT Environment Number 1"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># retrieve the germplasm list of the selected environment/location</span></span>
<span class="r-in"><span class="va">germplasm</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_germplasm_list.html">get_germplasm_list</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">pedigree_table</span> <span class="op">&lt;-</span> <span class="fu">get_pedigree_table</span><span class="op">(</span><span class="va">germplasm</span>, <span class="st">"germplasmName"</span>, <span class="st">"pedigree"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#############################</span></span>
<span class="r-in"><span class="co"># nadiv package way</span></span>
<span class="r-in"><span class="co"># library(nadiv)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># get additive relationship matrix in sparse matrix format</span></span>
<span class="r-in"><span class="co"># A &lt;- nadiv::makeA(pedigree_table)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># get A inverse matrix using base R function</span></span>
<span class="r-in"><span class="co"># AINV &lt;- solve(as.matrix(A))</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#############################</span></span>
<span class="r-in"><span class="co"># ASReml-R package way</span></span>
<span class="r-in"><span class="co"># library(asreml)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># represent A inverse matrix in efficient way using i,j index and Ainverse value</span></span>
<span class="r-in"><span class="co"># actual genotype names of any given index are in the attr(ainv, "rowNames")</span></span>
<span class="r-in"><span class="co"># ainv &lt;- asreml::ainverse(pedigree_table)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#############################</span></span>
<span class="r-in"><span class="co"># dummy data set for testing</span></span>
<span class="r-in"><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>genotype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"Y"</span><span class="op">)</span>,</span>
<span class="r-in">                   pedigree <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A//B/D/2/C"</span>, <span class="st">"B/C/3/A//B/C/2/D"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">pedigree_table</span> <span class="op">&lt;-</span> <span class="fu">get_pedigree_table</span><span class="op">(</span><span class="va">test</span>, <span class="st">"genotype"</span>, <span class="st">"pedigree"</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Khaled Al-Shamaa.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

